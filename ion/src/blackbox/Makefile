src += $(addprefix ion/src/blackbox/, \
  boot.cpp \
  ion.cpp \
  display.cpp \
  events.cpp \
)

src += $(addprefix ion/src/shared/, \
  console_line.cpp \
  console_stdio.cpp \
  crc32.cpp \
  crc32_padded.cpp \
  events.cpp \
  power.cpp \
  random.cpp \
  timing.cpp \
  dummy/backlight.cpp \
  dummy/battery.cpp \
  dummy/events_modifier.cpp \
  dummy/fcc_id.cpp \
  dummy/led.cpp \
  dummy/keyboard.cpp \
  dummy/rpi.o \
  dummy/serial_number.cpp \
  dummy/stack.cpp \
  dummy/usb.cpp \
)

$(call object_for,ion/src/shared/log_printf.cpp): SFLAGS=-Iion/include
$(call object_for,ion/src/shared/console_stdio.cpp): SFLAGS=-Iion/include
$(call object_for,ion/src/shared/events_stdin.cpp): SFLAGS=-Iion/include

SFLAGS += `libpng-config --cflags`
LDFLAGS += `libpng-config --ldflags`
